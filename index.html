<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Positive Psychologie Quiz</title>
  <style>
    :root{
      --bg1:#f6f3ff; --bg2:#eef6ff; --fg:#1f2937;
      --primary:#6d28d9; --primary2:#2563eb; --ok:#16a34a; --err:#dc2626;
      --card:#ffffff; --muted:#6b7280; --border:#e5e7eb;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
      color:var(--fg);
      background: radial-gradient(100% 100% at 0% 0%, var(--bg1), var(--bg2));
      min-height:100vh;
    }
    .container{max-width:860px;margin:0 auto;padding:24px}
    .center{display:flex;align-items:center;justify-content:center;text-align:center;min-height:60vh;flex-direction:column}
    h1{font-size:clamp(24px,3vw,36px);margin:0 0 8px 0}
    p.lead{color:var(--muted);max-width:720px;margin:0 auto 24px}
    .btn{
      background:linear-gradient(90deg,var(--primary),var(--primary2));
      color:#fff;border:none;border-radius:14px;padding:14px 28px;font-weight:600;cursor:pointer;
      box-shadow:0 8px 24px rgba(37,99,235,.25);
    }
    .btn:disabled{opacity:.7;cursor:not-allowed}
    .card{background:var(--card);border:1px solid var(--border);border-radius:22px;padding:22px 22px}
    .chip{
      display:inline-flex;align-items:center;gap:8px;
      background:linear-gradient(90deg,var(--primary),var(--primary2));color:#fff;border-radius:999px;
      padding:8px 14px;font-weight:600;margin:0 auto;
    }
    .qtitle{font-size:clamp(20px,2.6vw,28px);margin:18px 0 20px;text-align:center}
    .opt{width:100%;text-align:left;border:2px solid var(--border);border-radius:14px;padding:14px 16px;margin:10px 0;font-size:18px;background:#f9fafb;cursor:pointer}
    .opt:hover{border-color:#c7d2fe}
    .opt.sel{background:#ede9fe;border-color:#c4b5fd}
    .opt.ok{background:#ecfdf5;border-color:#bbf7d0}
    .opt.err{background:#fef2f2;border-color:#fecaca}
    .explain{border:2px solid #dbeafe;background:#eff6ff;border-radius:14px;padding:14px 16px;margin:16px 0}
    .explain.ok{border-color:#bbf7d0;background:#ecfdf5}
    .barwrap{height:10px;background:#e5e7eb;border-radius:999px;overflow:hidden}
    .bar{height:100%;width:0;background:linear-gradient(90deg,var(--primary),var(--primary2))}
    .row{display:grid;gap:14px}
    @media(min-width:700px){.row{grid-template-columns:1fr}}
    .muted{color:var(--muted)}
    .trenner{background:linear-gradient(90deg,#ede9fe,#dbeafe);border:1px solid #e9d5ff;border-radius:18px;padding:16px;margin:18px 0}
    .bonus{background:#fef9c3;border:2px solid #fde68a;border-radius:18px;padding:16px;margin:18px 0}
    .dist{display:grid;gap:16px}
    .dist-item{border:1px solid var(--border);border-radius:14px;padding:12px}
    .right{color:var(--ok);font-weight:700}
  </style>
</head>
<body>
  <div id="app"></div>

  <script>
  "use strict";

  // ---------- Icons (minimal) ----------
  const Icons = {
    Heart: "üåà", Zap: "‚ö°", Brain: "üß†", TrendingUp: "üíú", Handshake: "ü§ù",
    Check: "‚úÖ", Info: "üí°"
  };

  // ---------- State ----------
  let state = {
    started: false,
    currentQuestion: 0,
    selectedAnswer: null,
    showExplanation: false,
    scores: { broaden: 0, flow: 0, growth: 0, perma: 0, democracy: 0 },
    quizComplete: false
  };

  // ---------- Fragen (20) ----------
  const baseQuestions = [
    // üåà Broaden & Build
    { id: 1, category: "broaden", icon: "Heart",
      question: "Warum ist es wichtig, bewusst auf positive Dinge zu achten?",
      options: [
        { text: "Weil unser Gehirn negative Dinge st√§rker wahrnimmt", correct: true, explanation: "Negative Erlebnisse wirken intensiver ‚Äì um ausgeglichen zu bleiben, m√ºssen wir das Positive aktiv wahrnehmen und wertsch√§tzen." },
        { text: "Weil das Leben sonst langweilig w√§re", correct: false, explanation: "Es geht um Balance im Gehirn, nicht um Langeweile." },
        { text: "Weil man schlechte Gef√ºhle einfach verdr√§ngen sollte", correct: false, explanation: "Verdr√§ngen hilft nicht ‚Äì es geht um bewusstes Ausbalancieren, nicht um Wegdr√ºcken." }
      ]
    },
    { id: 2, category: "broaden", icon: "Heart",
      question: "Du bist gut gelaunt, weil dir jemand ein Kompliment gemacht hat. Was passiert, wenn du dich so f√ºhlst?",
      options: [
        { text: "Du bleibst ganz bei dir und blendest andere aus", correct: false, explanation: "Positive Emotionen √∂ffnen ‚Äì nicht verengen ‚Äì deinen Blick." },
        { text: "Du bist offener und siehst neue M√∂glichkeiten", correct: true, explanation: "Broaden & Build: Positive Emotionen erweitern Wahrnehmung und Handlungsspielr√§ume." },
        { text: "Du wirst unruhig und kannst dich schlechter konzentrieren", correct: false, explanation: "Eher das Gegenteil: kurze positive Momente stabilisieren die Aufmerksamkeit." }
      ]
    },
    { id: 3, category: "broaden", icon: "Heart",
      question: "Du bist gestresst vor einer Pr√ºfung. Was hilft dir, den Tunnelblick zu √∂ffnen?",
      options: [
        { text: "Musik h√∂ren, tief atmen oder kurz lachen", correct: true, explanation: "Mikro-Momente positiver Emotionen regulieren Stress und weiten den Blick." },
        { text: "Noch mehr Stoff in noch k√ºrzerer Zeit durchlesen", correct: false, explanation: "Das verst√§rkt oft den Tunnelblick und die √úberforderung." },
        { text: "Alles verdr√§ngen und hoffen, dass es klappt", correct: false, explanation: "Verdr√§ngen senkt kurzfristig Druck, l√∂st aber das Problem nicht." }
      ]
    },
    { id: 4, category: "broaden", icon: "Heart",
      question: "Wie wirken sich kleine Erfolge (‚ÄûIch hab‚Äôs geschafft!‚Äú) auf dein Denken aus?",
      options: [
        { text: "Du wirst selbstsicherer und motivierter", correct: true, explanation: "Erfolgserlebnisse st√§rken Selbstwirksamkeit und erzeugen Aufw√§rtsspiralen." },
        { text: "Du wirst √ºberheblich", correct: false, explanation: "Selbstvertrauen ist nicht gleich √úberheblichkeit ‚Äì es geht um realistische Zuversicht." },
        { text: "Du erwartest, dass alles immer leicht bleibt", correct: false, explanation: "Realistisches Denken bleibt wichtig ‚Äì Erfolge motivieren, garantieren aber nichts." }
      ]
    },

    // ‚ö° Flow
    { id: 5, category: "flow", icon: "Zap",
      question: "Du zeichnest, machst Musik oder bewegst dich (z. B. Sport, Tanzen) ‚Äì dabei vergeht die Zeit wie im Flug. Was passiert da?",
      options: [
        { text: "Du bist abgelenkt", correct: false },
        { text: "Du bist gestresst", correct: false },
        { text: "Du bist im Flow", correct: true }
      ]
    },
    { id: 6, category: "flow", icon: "Zap",
      question: "Wann kommst du am ehesten in den Flow?",
      options: [
        { text: "Wenn die Aufgabe leicht und langweilig ist", correct: false },
        { text: "Wenn die Aufgabe sehr schwierig ist", correct: false },
        { text: "Wenn die Aufgabe fordernd, aber machbar ist", correct: true }
      ]
    },
    { id: 7, category: "flow", icon: "Zap",
      question: "Warum kann Flow sogar beim Lernen entstehen?",
      options: [
        { text: "Weil du ganz im Moment bist und dich selbst vergisst", correct: true },
        { text: "Weil du einfach Gl√ºck hast", correct: false },
        { text: "Weil du nichts Neues lernst", correct: false }
      ]
    },
    { id: 8, category: "flow", icon: "Zap",
      question: "Wie kannst du Flow f√∂rdern?",
      options: [
        { text: "Durch ein klares Ziel, Ruhe und volle Konzentration", correct: true },
        { text: "Durch Multitasking ‚Äì viele Dinge nebeneinander machen", correct: false },
        { text: "Durch h√§ufige Ablenkungen", correct: false }
      ]
    },

    // üß† Growth Mindset
    { id: 9, category: "growth", icon: "Brain",
      question: "Du bekommst eine schlechte Note. Was w√§re eine Reaktion mit Growth Mindset?",
      options: [
        { text: "Ich kann das einfach nicht", correct: false },
        { text: "Ich kann das noch nicht ‚Äì ich √ºbe weiter", correct: true },
        { text: "Das ist so unfair", correct: false }
      ]
    },
    { id: 10, category: "growth", icon: "Brain",
      question: "Warum hilft dir der Satz ‚ÄûIch kann das noch nicht‚Äú?",
      options: [
        { text: "Er er√∂ffnet die M√∂glichkeit, dich zu verbessern", correct: true },
        { text: "Er klingt einfach gut", correct: false },
        { text: "Er macht dich automatisch kl√ºger", correct: false }
      ]
    },
    { id: 11, category: "growth", icon: "Brain",
      question: "Wie gehst du am besten mit Fehlern um?",
      options: [
        { text: "Ignorieren", correct: false },
        { text: "Dich dar√ºber √§rgern", correct: false },
        { text: "Analysieren und daraus lernen", correct: true }
      ]
    },
    { id: 12, category: "growth", icon: "Brain",
      question: "Warum ist Growth Mindset wichtig f√ºr die Zukunft?",
      options: [
        { text: "Weil man dann immer perfekt ist", correct: false },
        { text: "Weil du offen bleibst f√ºr Ver√§nderungen und neue Wege", correct: true },
        { text: "Weil du weniger lernen musst", correct: false }
      ]
    },

    // üíú PERMA + H
    { id: 13, category: "perma", icon: "TrendingUp",
      question: "Was tr√§gt am meisten zu echtem Wohlbefinden bei?",
      options: [
        { text: "Einfach nur Spa√ü haben", correct: false },
        { text: "Spa√ü, Sinn, Beziehungen und Gesundheit", correct: true },
        { text: "Immer zu gewinnen", correct: false }
      ]
    },
    { id: 14, category: "perma", icon: "TrendingUp",
      question: "Warum sind Freundschaften wichtig f√ºr dein Wohlbefinden?",
      options: [
        { text: "Sie geben Halt, Freude und Vertrauen", correct: true },
        { text: "Sie lenken dich vom Lernen ab", correct: false },
        { text: "Sie sind nur wichtig, wenn es dir gut geht", correct: false }
      ]
    },
    { id: 15, category: "perma", icon: "TrendingUp",
      question: "Wie kannst du auch an schwierigen Tagen etwas f√ºr dein Wohlbefinden tun?",
      options: [
        { text: "Dankbarkeit √ºben oder kurz spazieren gehen", correct: true },
        { text: "Alles verdr√§ngen und so tun, als ob nichts w√§re", correct: false },
        { text: "Dich isolieren und die Probleme mit dir alleine ausmachen", correct: false }
      ]
    },
    { id: 16, category: "perma", icon: "TrendingUp",
      question: "Warum geh√∂rt auch Scheitern zum guten Leben?",
      options: [
        { text: "Weil du dadurch wachsen und lernen kannst", correct: true },
        { text: "Weil Scheitern einfach Pech ist", correct: false },
        { text: "Weil nur Gl√ºck langweilig w√§re", correct: false }
      ]
    },

    // üó≥Ô∏è Demokratie
    { id: 17, category: "democracy", icon: "Handshake",
      question: "Wenn Menschen positive Emotionen erleben, sind sie in Diskussionen oft ‚Ä¶",
      options: [
        { text: "ungeduldig und festgefahren", correct: false },
        { text: "offener und empathischer", correct: true },
        { text: "leicht manipulierbar", correct: false }
      ]
    },
    { id: 18, category: "democracy", icon: "Handshake",
      question: "Warum ist ein Growth Mindset wichtig f√ºr eine demokratische Gesellschaft?",
      options: [
        { text: "Weil Menschen dann bereit sind, Neues zu lernen und Verantwortung zu √ºbernehmen", correct: true },
        { text: "Weil man immer recht behalten will", correct: false },
        { text: "Weil nur die Kl√ºgsten mitreden d√ºrfen", correct: false }
      ]
    },
    { id: 19, category: "democracy", icon: "Handshake",
      question: "Wie kann Flow demokratisches Engagement st√§rken?",
      options: [
        { text: "Menschen erleben Freude, Sinn und Wirksamkeit beim Mitgestalten", correct: true },
        { text: "Flow entsteht nur bei privaten Hobbys", correct: false },
        { text: "Durch Flow wird Politik zum reinen Vergn√ºgen ohne Anstrengung", correct: false }
      ]
    },
    { id: 20, category: "democracy", icon: "Handshake",
      question: "Warum geh√∂ren gute Beziehungen (PERMA) auch zur Demokratie?",
      options: [
        { text: "Weil Vertrauen und Dialog den Zusammenhalt f√∂rdern", correct: true },
        { text: "Weil man nur mit Freunden w√§hlen gehen darf", correct: false },
        { text: "Weil Streiten verboten ist", correct: false }
      ]
    }
  ];

  // ---------- Arbeitskopie + Shuffle ----------
  let questions = [];
  function shuffleInPlace(arr){
    for(let i=arr.length-1;i>0;i--){
      const j = Math.floor(Math.random()*(i+1));
      [arr[i],arr[j]]=[arr[j],arr[i]];
    }
    return arr;
  }
  function prepareQuestions(){
    questions = baseQuestions.map(q => ({ ...q, options: shuffleInPlace([...q.options]) }));
  }

  // ---------- Metadaten ----------
  const catName = {
    broaden:"Broaden & Build", flow:"Flow", growth:"Growth Mindset", perma:"PERMA+H", democracy:"Demokratie"
  };
  const catDesc = {
    broaden:"Positive Emotionen erweitern deinen Blick",
    flow:"Totales Aufgehen in einer T√§tigkeit",
    growth:"Dein Gehirn kann wachsen",
    perma:"Die 6 S√§ulen des Wohlbefindens",
    democracy:"Psychologische Grundlagen f√ºr Dialog & Beteiligung"
  };
  const blockStarts = { flow:4, growth:8, perma:12, democracy:16 }; // 0-index

  // ---------- Feedback ----------
  function personalizedFeedback(){
    const total = Object.values(state.scores).reduce((a,b)=>a+b,0);
    const pct = Math.round((total / questions.length) * 100);
    let msg = pct>=80 ? "Wow! üåü Du hast Positive Psychologie super drauf. "
            : pct>=60 ? "Gut gemacht! üëè Du kennst dich schon gut aus. "
            : pct>=40 ? "Guter Start! üí™ Bleib dran. "
            : "Super, dass du mitgemacht hast! üéØ ";

    const cats = Object.entries(state.scores).map(([c,s])=>{
      const max = questions.filter(q=>q.category===c).length;
      return {c,s,max,p: max? (s/max)*100 : 0};
    });
    const ps = cats.map(x=>x.p);
    const maxP = Math.max(...ps), minP = Math.min(...ps);
    if(maxP===minP){
      msg += "Du warst in allen Bereichen gleich stark.";
    }else{
      const strongest = cats.reduce((a,b)=>a.p>b.p?a:b);
      const weakest  = cats.reduce((a,b)=>a.p<b.p?a:b);
      if(strongest.p>0) msg += `Stark bei: ${catName[strongest.c]}. `;
      if(weakest.p<strongest.p && weakest.p<75) msg += `Bei ${catName[weakest.c]} kannst du noch nachsch√§rfen.`;
    }
    return msg;
  }

  // ---------- Views ----------
  function viewStart(){
    return `
      <div class="container center">
        <h1>Positive Psychologie Quiz</h1>
        <p class="lead">Teste dein Wissen √ºber Broaden & Build, Flow, Growth Mindset, PERMA+H und ihren Bezug zur Demokratie.</p>
        <button class="btn" data-action="start">Jetzt starten</button>
      </div>
    `;
  }

  function categoryTrennerHTML(key){
    return `
      <div class="trenner">
        <div style="font-weight:700;color:#6d28d9">üåà Neues Thema</div>
        <div style="margin-top:6px;font-size:18px;font-weight:700">${catName[key]}</div>
        <div class="muted" style="margin-top:4px">${catDesc[key]}</div>
      </div>
    `;
  }
  function democracyBonusHTML(){
    return `
      <div class="bonus">
        <div style="font-weight:700">üó≥Ô∏è Bonus-Thema: Positive Psychologie & Demokratie</div>
        <div style="margin-top:6px">Wie st√§rken positive Emotionen, Flow, Growth Mindset und Beziehungen unser Zusammenleben, Dialog & Beteiligung?</div>
      </div>
    `;
  }

  function viewQuestion(){
    const q = questions[state.currentQuestion];
    const progress = ((state.currentQuestion+1)/questions.length)*100;

    let intro = "";
    if(state.currentQuestion===blockStarts.flow) intro=categoryTrennerHTML("flow");
    if(state.currentQuestion===blockStarts.growth) intro=categoryTrennerHTML("growth");
    if(state.currentQuestion===blockStarts.perma) intro=categoryTrennerHTML("perma");
    if(state.currentQuestion===blockStarts.democracy) intro=democracyBonusHTML();

    const optionsHtml = q.options.map((opt,i)=>{
      const isSel = state.selectedAnswer===i;
      const show = state.showExplanation && isSel;
      let cls = "opt";
      if(!state.showExplanation && isSel) cls += " sel";
      if(state.showExplanation && show) cls += opt.correct? " ok" : " err";
      return `<button class="${cls}" data-action="answer" data-index="${i}" ${state.showExplanation?"disabled":""}>${opt.text}</button>`;
    }).join("");

    const explanationHtml = state.showExplanation ? `
      <div class="explain ${q.options[state.selectedAnswer].correct ? 'ok' : ''}">
        <div style="font-weight:700;margin-bottom:6px">${q.options[state.selectedAnswer].correct ? Icons.Check+" Richtig!" : Icons.Info+" Gut zu wissen:"}</div>
        <div>${q.options[state.selectedAnswer].explanation || ""}</div>
      </div>
      <button class="btn" data-action="next">${state.currentQuestion<questions.length-1 ? "N√§chste Frage ‚Üí" : "Ergebnis anzeigen üéâ"}</button>
    ` : "";

    return `
      <div class="container">
        <div style="margin-bottom:14px">
          <div class="muted" style="display:flex;justify-content:space-between;font-size:14px">
            <span>Frage ${state.currentQuestion+1} von ${questions.length}</span>
            <span>${Math.round(progress)}%</span>
          </div>
          <div class="barwrap"><div class="bar" style="width:${progress}%"></div></div>
        </div>

        ${intro}

        <div class="card">
          <div class="chip" title="${catName[q.category]}">${Icons[q.icon]} <span>${catName[q.category]}</span></div>
          <div class="qtitle">${q.question}</div>
          <div class="row">
            ${optionsHtml}
          </div>
          ${explanationHtml}
        </div>
      </div>
    `;
  }

  function viewResults(){
    const total = Object.values(state.scores).reduce((a,b)=>a+b,0);
    const pct = Math.round((total/questions.length)*100);

    const dist = Object.entries(state.scores).map(([category,score])=>{
      const max = questions.filter(q=>q.category===category).length;
      const p = max? (score/max)*100 : 0;
      return `
        <div class="dist-item">
          <div style="display:flex;justify-content:space-between;align-items:baseline">
            <div>
              <div style="font-weight:600">${catName[category]}</div>
              <div class="muted" style="font-size:12px">${catDesc[category]}</div>
            </div>
            <div class="muted">${score}/${max}</div>
          </div>
          <div class="barwrap" style="margin-top:8px"><div class="bar" style="width:${p}%"></div></div>
        </div>
      `;
    }).join("");

    return `
      <div class="container">
        <div class="card">
          <div style="text-align:center">
            <div style="font-size:42px;margin-bottom:8px">üéâ</div>
            <div style="font-size:26px;font-weight:700;margin-bottom:6px">Quiz geschafft!</div>
            <div style="font-size:40px;font-weight:800;color:var(--primary)">${pct}%</div>
            <div class="muted" style="margin-top:6px">${total} von ${questions.length} Fragen richtig</div>
          </div>

          <div class="trenner" style="margin-top:18px">
            <div>${personalizedFeedback()}</div>
          </div>

          <div class="dist">
            ${dist}
          </div>

          <div style="margin-top:16px">
            <button class="btn" data-action="reset" style="width:100%">Nochmal probieren</button>
          </div>
        </div>
      </div>
    `;
  }

  // ---------- Render ----------
  function render(){
    const root = document.getElementById("app");
    if(!state.started) root.innerHTML = viewStart();
    else if(state.quizComplete) root.innerHTML = viewResults();
    else root.innerHTML = viewQuestion();
    if(state.showExplanation){
      const el = root.querySelector(".explain");
      if(el) el.scrollIntoView({behavior:"smooth", block:"center"});
    }
  }

  // ---------- Events ----------
  document.addEventListener("click",(e)=>{
    const btn = e.target.closest("[data-action]");
    if(!btn) return;
    const action = btn.getAttribute("data-action");

    if(action==="start"){
      prepareQuestions();
      state.started = true; render(); return;
    }
    if(action==="answer" && !state.showExplanation){
      const idx = Number(btn.getAttribute("data-index"));
      state.selectedAnswer = idx;
      state.showExplanation = true;
      const q = questions[state.currentQuestion];
      if(q.options[idx].correct) state.scores[q.category]++;
      render(); return;
    }
    if(action==="next"){
      if(state.currentQuestion < questions.length-1){
        state.currentQuestion++; state.selectedAnswer=null; state.showExplanation=false;
      } else {
        state.quizComplete = true;
      }
      render(); return;
    }
    if(action==="reset"){
      state = { started:false, currentQuestion:0, selectedAnswer:null, showExplanation:false, scores:{broaden:0,flow:0,growth:0,perma:0,democracy:0}, quizComplete:false };
      render(); return;
    }
  });

  // ---------- Init ----------
  window.addEventListener("DOMContentLoaded", render);
  </script>
</body>
</html>
