<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Positive Psychologie Quiz</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px);} to { opacity: 1; transform: translateY(0);} }
    .animate-fade-in { animation: fadeIn 0.3s ease-out; }
  </style>
</head>
<body class="bg-gradient-to-br from-purple-50 via-blue-50 to-pink-50 min-h-screen">
  <!-- Safelist f√ºr Tailwind-JIT (f√ºr Zustandsklassen) -->
  <template id="tailwind-safelist">
    <span class="text-green-600 text-red-600 bg-green-100 bg-red-100 border-green-500 border-red-500"></span>
  </template>

  <div id="app"></div>

  <script>
    "use strict";

    /* ---------- Icons ---------- */
    const Icons = {
      Heart: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>`,
      Zap: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>`,
      Brain: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg>`,
      TrendingUp: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg>`,
      Handshake: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 12l3-3m0 0l3 3m-3-3v8M7 7h4a4 4 0 014 4v0M3 11l4-4m0 0l4 4m-4-4v10"></path></svg>`,
      CheckCircle: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>`,
      XCircle: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>`
    };

    /* ---------- State ---------- */
    let state = {
      started: false,
      currentQuestion: 0,
      selectedAnswer: null,
      showExplanation: false,
      scores: { broaden: 0, flow: 0, growth: 0, perma: 0, democracy: 0 },
      quizComplete: false
    };

    /* ---------- Fragen (20) ---------- */
    const questions = [
      /* --- Broaden & Build (4) --- */
      { id: 1, category: "broaden", icon: "Heart",
        question: "Du bist gut gelaunt, weil dir jemand ein Kompliment gemacht hat. Was passiert oft, wenn du dich so f√ºhlst?",
        options: [
          { text: "Du bleibst ganz bei dir und blendest andere aus", correct: false, explanation: "Positive Emotionen √∂ffnen ‚Äì nicht verengen ‚Äì deinen Blick." },
          { text: "Du bist offener und siehst neue M√∂glichkeiten", correct: true, explanation: "Broaden & Build: Positive Emotionen erweitern Wahrnehmung und Handlungsspielr√§ume." },
          { text: "Du wirst unruhig und kannst dich schlechter konzentrieren", correct: false, explanation: "Eher das Gegenteil: kurze positive Momente stabilisieren die Aufmerksamkeit." }
        ]
      },
      { id: 2, category: "broaden", icon: "Heart",
        question: "Du bist gestresst vor einer Pr√ºfung. Was hilft dir, den Tunnelblick zu √∂ffnen?",
        options: [
          { text: "Musik h√∂ren, tief atmen oder kurz lachen", correct: true, explanation: "Mikro-Momente positiver Emotionen regulieren Stress und weiten den Blick." },
          { text: "Noch mehr Stoff in noch weniger Zeit durchlesen", correct: false, explanation: "Das verst√§rkt oft den Tunnelblick und die √úberforderung." },
          { text: "Alles verdr√§ngen und hoffen, es klappt", correct: false, explanation: "Verdr√§ngen senkt kurzfristig Druck, l√∂st aber das Problem nicht." }
        ]
      },
      { id: 3, category: "broaden", icon: "Heart",
        question: "Warum lohnt es sich, kleine positive Erlebnisse bewusst wahrzunehmen?",
        options: [
          { text: "Weil sie dir Energie und langfristige St√§rke geben", correct: true, explanation: "Sie bauen Ressourcen wie Optimismus, Kreativit√§t und Beziehungen auf." },
          { text: "Weil sie nur kurzfristig Spa√ü machen", correct: false, explanation: "Die Effekte reichen √ºber den Moment hinaus." },
          { text: "Weil du dann keine schlechten Gef√ºhle mehr hast", correct: false, explanation: "Negative Gef√ºhle bleiben Teil des Lebens ‚Äì aber besser regulierbar." }
        ]
      },
      { id: 4, category: "broaden", icon: "Heart",
        question: "Wie wirken sich kleine Erfolge (‚ÄûIch hab‚Äôs geschafft!‚Äú) auf dein Denken aus?",
        options: [
          { text: "Du wirst selbstsicherer und motivierter", correct: true, explanation: "Erfolgserlebnisse st√§rken Selbstwirksamkeit und erzeugen Aufw√§rtsspiralen." },
          { text: "Du wirst √ºberheblich", correct: false, explanation: "Selbstvertrauen ist nicht gleich √úberheblichkeit ‚Äì es geht um realistische Zuversicht." },
          { text: "Du erwartest, dass alles immer leicht bleibt", correct: false, explanation: "Realistisches Denken bleibt wichtig ‚Äì Erfolge motivieren, garantieren aber nichts." }
        ]
      },

      /* --- Flow (4) --- */
      { id: 5, category: "flow", icon: "Zap",
        question: "Du zeichnest, machst Musik oder bist in Bewegung (z. B. Sport, Tanzen) ‚Äì pl√∂tzlich vergeht die Zeit wie im Flug. Was passiert da?",
        options: [
          { text: "Du bist abgelenkt", correct: false, explanation: "Ablenkung ist das Gegenteil: Flow ist hochfokussiert." },
          { text: "Du bist gestresst", correct: false, explanation: "Flow geht mit positiver Aktivierung, nicht mit Distress einher." },
          { text: "Du bist im Flow", correct: true, explanation: "Tiefe Vertiefung bei Passung von K√∂nnen & Herausforderung ‚Äì typische Flow-Erfahrung." }
        ]
      },
      { id: 6, category: "flow", icon: "Zap",
        question: "Wann kommst du am ehesten in den Flow?",
        options: [
          { text: "Wenn die Aufgabe leicht und langweilig ist", correct: false, explanation: "Zu leicht ‚Üí Langeweile, kein Flow." },
          { text: "Wenn sie zu schwer ist", correct: false, explanation: "Zu schwer ‚Üí √úberforderung/Stress, kein Flow." },
          { text: "Wenn sie fordernd, aber machbar ist", correct: true, explanation: "Bester Sweet Spot: Herausforderung ‚âà F√§higkeit + klares Ziel + Feedback." }
        ]
      },
      { id: 7, category: "flow", icon: "Zap",
        question: "Warum kann Flow sogar beim Lernen entstehen?",
        options: [
          { text: "Weil du ganz im Moment bist und dich selbst vergisst", correct: true, explanation: "Flow erleichtert tiefe Konzentration und effizienteres Lernen." },
          { text: "Weil du einfach Gl√ºck hast", correct: false, explanation: "Flow folgt Bedingungen ‚Äì Gl√ºck ist nicht erforderlich." },
          { text: "Weil du nichts Neues lernst", correct: false, explanation: "Gerade die fordernde Lernzone beg√ºnstigt Flow." }
        ]
      },
      { id: 8, category: "flow", icon: "Zap",
        question: "Wie kannst du Flow f√∂rdern?",
        options: [
          { text: "Durch klares Ziel, Ruhe und volle Konzentration", correct: true, explanation: "Ziele, Fokus und St√∂rungsfreiheit steigern die Flow-Wahrscheinlichkeit." },
          { text: "Durch Multitasking", correct: false, explanation: "Multitasking zerschie√üt Aufmerksamkeit und Flow." },
          { text: "Durch h√§ufige Ablenkungen", correct: false, explanation: "Kurze Pausen ja ‚Äì aber h√§ufige Ablenkungen verhindern Flow." }
        ]
      },

      /* --- Growth Mindset (4) --- */
      { id: 9, category: "growth", icon: "Brain",
        question: "Du bekommst eine schlechte Note. Was w√§re eine Reaktion mit Growth Mindset?",
        options: [
          { text: "‚ÄûIch kann das einfach nicht.‚Äú", correct: false, explanation: "Das ist Fixed Mindset ‚Äì es blockiert Lernen." },
          { text: "‚ÄûIch kann das noch nicht ‚Äì ich √ºbe weiter.‚Äú", correct: true, explanation: "‚ÄûNoch‚Äú √∂ffnet den Lernweg und st√§rkt Motivation." },
          { text: "‚ÄûDas ist unfair!‚Äú", correct: false, explanation: "Kern ist nicht Schuldzuweisung, sondern Lernstrategie." }
        ]
      },
      { id: 10, category: "growth", icon: "Brain",
        question: "Warum hilft dir der Satz ‚ÄûIch kann das noch nicht‚Äú?",
        options: [
          { text: "Er √∂ffnet die M√∂glichkeit, dich zu verbessern", correct: true, explanation: "Er f√∂rdert Anstrengungsbereitschaft und Ausdauer." },
          { text: "Er klingt einfach netter", correct: false, explanation: "Er ist vor allem wirksam, nicht nur freundlich." },
          { text: "Er macht dich automatisch kl√ºger", correct: false, explanation: "Er motiviert ‚Äì Lernen braucht weiterhin √úbung." }
        ]
      },
      { id: 11, category: "growth", icon: "Brain",
        question: "Wie gehst du am besten mit Fehlern um?",
        options: [
          { text: "Ignorieren", correct: false, explanation: "Dann wiederholst du sie eher ‚Äì Lernchance verpasst." },
          { text: "Dich dar√ºber √§rgern", correct: false, explanation: "Gef√ºhle sind okay ‚Äì entscheidend ist Lernen danach." },
          { text: "Analysieren und daraus lernen", correct: true, explanation: "Fehler sind Feedback ‚Äì nutze sie bewusst." }
        ]
      },
      { id: 12, category: "growth", icon: "Brain",
        question: "Warum ist Growth Mindset wichtig f√ºr die Zukunft?",
        options: [
          { text: "Weil man dann immer perfekt ist", correct: false, explanation: "Perfektion ist illusorisch ‚Äì es geht um Entwicklung." },
          { text: "Weil du offener bleibst f√ºr Ver√§nderung und neue Wege", correct: true, explanation: "Anpassungsf√§higkeit ist zentral in einer dynamischen Welt." },
          { text: "Weil du weniger lernen musst", correct: false, explanation: "Im Gegenteil ‚Äì du lernst kontinuierlich." }
        ]
      },

      /* --- PERMA+H (4) --- */
      { id: 13, category: "perma", icon: "TrendingUp",
        question: "Was tr√§gt am meisten zu echtem Wohlbefinden bei?",
        options: [
          { text: "Nur Spa√ü haben", correct: false, explanation: "Spa√ü allein reicht nicht ‚Äì zu kurz gedacht." },
          { text: "Spa√ü, Sinn, Beziehungen und Gesundheit", correct: true, explanation: "PERMA+H: Emotionen, Engagement, Beziehungen, Sinn, Leistung, Gesundheit." },
          { text: "Immer gewinnen", correct: false, explanation: "Erfolg ist nur ein Baustein ‚Äì Balance ist wichtig." }
        ]
      },
      { id: 14, category: "perma", icon: "TrendingUp",
        question: "Warum sind Freundschaften wichtig f√ºr dein Wohlbefinden?",
        options: [
          { text: "Sie geben Halt, Freude und Vertrauen", correct: true, explanation: "Beziehungen (R) sind Kernquelle f√ºr Gl√ºck und Resilienz." },
          { text: "Sie lenken vom Lernen ab", correct: false, explanation: "Gute Beziehungen k√∂nnen Lernen st√ºtzen." },
          { text: "Sie sind nur bei Erfolg wichtig", correct: false, explanation: "Beziehungen tragen durch Erfolge und Krisen." }
        ]
      },
      { id: 15, category: "perma", icon: "TrendingUp",
        question: "Wie kannst du auch an schwierigen Tagen etwas f√ºr dein Wohlbefinden tun?",
        options: [
          { text: "Dankbarkeit √ºben oder kurz spazieren gehen", correct: true, explanation: "Kleine, konkrete Handlungen st√§rken Selbstf√ºrsorge und Stimmung." },
          { text: "Alles verdr√§ngen", correct: false, explanation: "Verdr√§ngen l√∂st nichts ‚Äì kleine Schritte helfen wirklich." },
          { text: "Dich isolieren", correct: false, explanation: "Isolation senkt Wohlbefinden ‚Äì Kontakt tut gut." }
        ]
      },
      { id: 16, category: "perma", icon: "TrendingUp",
        question: "Warum geh√∂rt auch Scheitern zum guten Leben?",
        options: [
          { text: "Weil du dadurch wachsen und lernen kannst", correct: true, explanation: "Reflektiertes Scheitern ist Lernmotor." },
          { text: "Weil du Pech hast", correct: false, explanation: "Es geht nicht um Pech, sondern Lernchancen." },
          { text: "Weil Gl√ºck langweilig w√§re", correct: false, explanation: "Pointiert, aber nicht der Kern ‚Äì es geht um Entwicklung." }
        ]
      },

      /* --- Demokratie (4) --- */
      { id: 17, category: "democracy", icon: "Handshake",
        question: "Wenn Menschen positive Emotionen erleben, sind sie in Diskussionen oft ‚Ä¶",
        options: [
          { text: "ungeduldig und festgefahren", correct: false, explanation: "Das passt eher zu starkem Stress, nicht zu positiven Emotionen." },
          { text: "offener und empathischer", correct: true, explanation: "Positive Emotionen f√∂rdern Perspektivwechsel und Dialogbereitschaft." },
          { text: "leicht manipulierbar", correct: false, explanation: "Offenheit hei√üt nicht Naivit√§t ‚Äì Differenzierung bleibt m√∂glich." }
        ]
      },
      { id: 18, category: "democracy", icon: "Handshake",
        question: "Warum ist ein Growth Mindset wichtig f√ºr eine demokratische Gesellschaft?",
        options: [
          { text: "Weil Menschen dann bereit sind, Neues zu lernen und Verantwortung zu √ºbernehmen", correct: true, explanation: "Lernkultur, Reflexion und Beteiligung st√§rken demokratische Prozesse." },
          { text: "Weil man immer recht behalten will", correct: false, explanation: "Rechthaberei schadet Dialog und Kompromiss." },
          { text: "Weil nur die Kl√ºgsten mitreden d√ºrfen", correct: false, explanation: "Demokratie lebt von Vielfalt, nicht Elitarismus." }
        ]
      },
      { id: 19, category: "democracy", icon: "Handshake",
        question: "Wie kann Flow demokratisches Engagement st√§rken?",
        options: [
          { text: "Menschen erleben Freude, Sinn und Wirksamkeit beim Mitgestalten", correct: true, explanation: "Flow speist intrinsische Motivation und Ausdauer im Ehrenamt/Projekten." },
          { text: "Menschen verlieren das Interesse an Politik", correct: false, explanation: "Das Gegenteil: Flow f√∂rdert Dranbleiben." },
          { text: "Flow hat mit Gesellschaft nichts zu tun", correct: false, explanation: "Flow greift √ºberall, auch im zivilen Engagement." }
        ]
      },
      { id: 20, category: "democracy", icon: "Handshake",
        question: "Warum geh√∂ren gute Beziehungen (PERMA) auch zur Demokratie?",
        options: [
          { text: "Weil Vertrauen und Dialog den Zusammenhalt f√∂rdern", correct: true, explanation: "Beziehungsqualit√§t st√ºtzt Respekt, Kooperation und Kompromissf√§higkeit." },
          { text: "Weil man nur mit Freunden w√§hlen darf", correct: false, explanation: "Wahlen sind allgemein und frei ‚Äì Beziehungen sind f√ºrs Klima wichtig, nicht f√ºr Wahlrecht." },
          { text: "Weil Streit verboten ist", correct: false, explanation: "Streit ist erlaubt ‚Äì entscheidend ist respektvolle Streitkultur." }
        ]
      }
    ];

    /* ---------- Kategorienamen & Beschreibungen ---------- */
    const catName = {
      broaden: "Broaden & Build",
      flow: "Flow",
      growth: "Growth Mindset",
      perma: "PERMA+H",
      democracy: "Demokratie"
    };
    const catDesc = {
      broaden: "Positive Emotionen erweitern deinen Blick",
      flow: "Totales Aufgehen in einer T√§tigkeit",
      growth: "Dein Gehirn kann wachsen",
      perma: "Die 6 S√§ulen des Wohlbefindens",
      democracy: "Psychologische Grundlagen f√ºr Dialog & Beteiligung"
    };

    /* ---------- Block-Grenzen (f√ºr Trenner & Bonus-Box) ---------- */
    const blockStarts = {
      flow: 4,       // Frageindex 4 (5. Frage)
      growth: 8,     // Frageindex 8 (9. Frage)
      perma: 12,     // Frageindex 12 (13. Frage)
      democracy: 16  // Frageindex 16 (17. Frage)
    };

    /* ---------- Feedback ---------- */
    function personalizedFeedback() {
      const total = Object.values(state.scores).reduce((a, b) => a + b, 0);
      const pct = Math.round((total / questions.length) * 100);
      let msg =
        pct >= 80 ? "Wow! üåü Du hast Positive Psychologie super drauf. " :
        pct >= 60 ? "Gut gemacht! üëè Du kennst dich schon gut aus. " :
        pct >= 40 ? "Guter Start! üí™ Bleib dran. " :
                    "Super, dass du mitgemacht hast! üéØ ";

      const cats = Object.entries(state.scores).map(([c, s]) => {
        const max = questions.filter(q => q.category === c).length;
        return { c, s, max, p: (s / max) * 100 };
      });
      const strongest = cats.reduce((a, b) => a.p > b.p ? a : b);
      const weakest = cats.reduce((a, b) => a.p < b.p ? a : b);

      if (strongest.p > 0) msg += `Stark bei: ${catName[strongest.c]}. `;
      if (weakest.p < strongest.p && weakest.p < 75) msg += `Bei ${catName[weakest.c]} kannst du noch nachsch√§rfen.`;

      return msg;
    }

    /* ---------- Views ---------- */
    function viewStart() {
      return `
        <div class="min-h-screen flex flex-col items-center justify-center text-center p-8">
          <h1 class="text-3xl md:text-4xl font-bold mb-4 text-gray-800">Positive Psychologie Quiz</h1>
          <p class="text-gray-600 mb-8 max-w-2xl">
            Teste dein Wissen √ºber Broaden & Build, Flow, Growth Mindset, PERMA+H und ihren Bezug zur Demokratie.
          </p>
          <button data-action="start" class="px-8 py-4 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-xl font-semibold hover:from-purple-700 hover:to-blue-700 shadow-lg">
            Jetzt starten
          </button>
        </div>
      `;
    }

    function categoryTrennerHTML(key) {
      const title = catName[key];
      const desc = catDesc[key];
      return `
        <div class="bg-gradient-to-r from-purple-100 to-blue-100 border border-purple-200 rounded-2xl p-6 mb-6 animate-fade-in">
          <div class="flex items-center gap-3">
            <div class="text-purple-700 font-semibold">üåà Neues Thema</div>
            <div class="h-px flex-1 bg-purple-300/60"></div>
          </div>
          <div class="mt-4">
            <h3 class="text-xl font-bold text-gray-800">${title}</h3>
            <p class="text-gray-700 mt-1">${desc}</p>
          </div>
        </div>
      `;
    }

    function democracyBonusHTML() {
      return `
        <div class="bg-yellow-50 border-2 border-yellow-200 rounded-2xl p-6 mb-6 animate-fade-in">
          <div class="flex items-center gap-2 text-yellow-700 font-semibold">
            üó≥Ô∏è Bonus-Thema: Positive Psychologie & Demokratie
          </div>
          <p class="text-gray-800 mt-2">
            Wie st√§rken positive Emotionen, Flow, Growth Mindset und Beziehungen unser Zusammenleben, Dialog & Beteiligung?
          </p>
        </div>
      `;
    }

    function viewQuestion() {
      const q = questions[state.currentQuestion];
      const progress = ((state.currentQuestion + 1) / questions.length) * 100;

      // ggf. Trenner/Bonus-Box einblenden, wenn ein neuer Block beginnt
      let intro = "";
      if (state.currentQuestion === blockStarts.flow) intro = categoryTrennerHTML("flow");
      if (state.currentQuestion === blockStarts.growth) intro = categoryTrennerHTML("growth");
      if (state.currentQuestion === blockStarts.perma) intro = categoryTrennerHTML("perma");
      if (state.currentQuestion === blockStarts.democracy) intro = democracyBonusHTML();

      const optionsHtml = q.options.map((opt, i) => {
        const isSelected = state.selectedAnswer === i;
        const isCorrect = opt.correct;
        const showResult = state.showExplanation && isSelected;

        let cls = 'w-full p-5 rounded-xl text-left transition-all duration-300 font-medium text-lg ';
        if (!state.showExplanation) {
          cls += (isSelected ? 'bg-purple-100 border-2 border-purple-400 ' : 'bg-gray-50 border-2 border-gray-200 hover:border-purple-300 hover:shadow-md ') + 'cursor-pointer';
        } else {
          cls += 'cursor-not-allowed ';
          if (showResult && isCorrect) cls += 'bg-green-100 border-2 border-green-500';
          else if (showResult && !isCorrect) cls += 'bg-red-100 border-2 border-red-500';
          else cls += 'bg-gray-50 border-2 border-gray-200';
        }

        const icon = showResult
          ? `<div class="ml-4 ${isCorrect ? 'text-green-600' : 'text-red-600'}">${isCorrect ? Icons.CheckCircle : Icons.XCircle}</div>`
          : '';

        return `
          <button class="${cls}" data-action="answer" data-index="${i}" ${state.showExplanation ? 'disabled' : ''}>
            <div class="flex items-center justify-between">
              <span class="flex-1">${opt.text}</span>
              ${icon}
            </div>
          </button>
        `;
      }).join('');

      const explanationHtml = state.showExplanation ? `
        <div class="p-6 rounded-xl mb-6 animate-fade-in ${q.options[state.selectedAnswer].correct ? 'bg-green-50 border-2 border-green-200' : 'bg-blue-50 border-2 border-blue-200'}">
          <h3 class="font-bold text-lg mb-2 text-gray-800">
            ${q.options[state.selectedAnswer].correct ? '‚úÖ Richtig!' : 'üí° Gut zu wissen:'}
          </h3>
          <p class="text-gray-700 leading-relaxed">${q.options[state.selectedAnswer].explanation}</p>
        </div>
        <button data-action="next" class="w-full bg-gradient-to-r from-purple-600 to-blue-600 text-white py-4 rounded-xl font-semibold hover:from-purple-700 hover:to-blue-700 shadow-lg">
          ${state.currentQuestion < questions.length - 1 ? 'N√§chste Frage ‚Üí' : 'Ergebnis anzeigen üéâ'}
        </button>
      ` : '';

      return `
        <div class="min-h-screen p-4 md:p-8">
          <div class="max-w-3xl mx-auto">
            <div class="mb-6">
              <div class="flex justify-between text-sm text-gray-600 mb-2">
                <span>Frage ${state.currentQuestion + 1} von ${questions.length}</span>
                <span>${Math.round(progress)}%</span>
              </div>
              <div class="w-full bg-gray-200 rounded-full h-2">
                <div class="bg-gradient-to-r from-purple-600 to-blue-600 h-2 rounded-full transition-all duration-300" style="width:${progress}%"></div>
              </div>
            </div>

            ${intro}

            <div class="bg-white rounded-3xl shadow-2xl p-6 md:p-10">
              <div class="flex items-center justify-center mb-6">
                <div class="bg-gradient-to-r from-purple-500 to-blue-500 text-white px-6 py-2 rounded-full flex items-center gap-2">
                  ${Icons[q.icon]}
                  <span class="font-semibold">${catName[q.category]}</span>
                </div>
              </div>

              <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-8 text-center leading-relaxed">${q.question}</h2>

              <div class="space-y-4 mb-8">
                ${optionsHtml}
              </div>

              ${explanationHtml}
            </div>
          </div>
        </div>
      `;
    }

    function viewResults() {
      const total = Object.values(state.scores).reduce((a, b) => a + b, 0);
      const pct = Math.round((total / questions.length) * 100);

      const dist = Object.entries(state.scores).map(([category, score]) => {
        const max = questions.filter(q => q.category === category).length;
        const p = max > 0 ? (score / max) * 100 : 0;
        return `
          <div class="space-y-2">
            <div class="flex justify-between text-sm">
              <div>
                <span class="font-medium text-gray-700">${catName[category]}</span>
                <p class="text-xs text-gray-500">${catDesc[category]}</p>
              </div>
              <span class="text-gray-600">${score}/${max}</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-3">
              <div class="bg-gradient-to-r from-purple-500 to-blue-500 h-3 rounded-full transition-all duration-500" style="width:${p}%"></div>
            </div>
          </div>
        `;
      }).join('');

      return `
        <div class="min-h-screen p-8">
          <div class="max-w-3xl mx-auto">
            <div class="bg-white rounded-3xl shadow-2xl p-8 md:p-12">
              <div class="text-center mb-8">
                <div class="text-6xl mb-4">üéâ</div>
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Quiz geschafft!</h2>
                <div class="text-6xl font-bold text-purple-600 mb-4">${pct}%</div>
                <p class="text-xl text-gray-600">${total} von ${questions.length} Fragen richtig</p>
              </div>

              <div class="bg-gradient-to-r from-purple-100 to-blue-100 rounded-2xl p-6 mb-8">
                <p class="text-lg text-gray-700 leading-relaxed">${personalizedFeedback()}</p>
              </div>

              <div class="space-y-4 mb-8">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Deine Punkteverteilung:</h3>
                ${dist}
              </div>

              <button data-action="reset" class="w-full bg-gradient-to-r from-purple-600 to-blue-600 text-white py-4 rounded-xl font-semibold hover:from-purple-700 hover:to-blue-700 shadow-lg">
                Nochmal probieren
              </button>
            </div>
          </div>
        </div>
      `;
    }

    /* ---------- Render ---------- */
    function render() {
      const root = document.getElementById('app');
      if (!state.started) {
        root.innerHTML = viewStart();
      } else if (state.quizComplete) {
        root.innerHTML = viewResults();
      } else {
        root.innerHTML = viewQuestion();
      }

      if (state.showExplanation) {
        const el = root.querySelector('.animate-fade-in');
        if (el) el.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    }

    /* ---------- Event Delegation ---------- */
    document.addEventListener('click', (e) => {
      const btn = e.target.closest('[data-action]');
      if (!btn) return;

      const action = btn.getAttribute('data-action');

      if (action === 'start') {
        state.started = true;
        render();
        return;
      }

      if (action === 'answer' && !state.showExplanation) {
        const idx = Number(btn.getAttribute('data-index'));
        state.selectedAnswer = idx;
        state.showExplanation = true;
        const q = questions[state.currentQuestion];
        if (q.options[idx].correct) state.scores[q.category]++;
        render();
        return;
      }

      if (action === 'next') {
        if (state.currentQuestion < questions.length - 1) {
          state.currentQuestion++;
          state.selectedAnswer = null;
          state.showExplanation = false;
        } else {
          state.quizComplete = true;
        }
        render();
        return;
      }

      if (action === 'reset') {
        state = { started:false, currentQuestion:0, selectedAnswer:null, showExplanation:false, scores:{broaden:0,flow:0,growth:0,perma:0,democracy:0}, quizComplete:false };
        render();
        return;
      }
    });

    /* ---------- Start ---------- */
    window.addEventListener('DOMContentLoaded', render);
  </script>
</body>
</html>
